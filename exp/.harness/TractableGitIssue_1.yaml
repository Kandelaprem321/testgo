template:
    name: TractableGitIssue
    identifier: TractableGitIssue
    versionLabel: "1"
    type: Step
    projectIdentifier: RajathaTest2
    orgIdentifier: default
    tags: {}
    spec:
        type: Run
        spec:
            connectorRef: dockerrajatha
            image: bash:alpine3.15
            shell: Bash
            command: "#!/bin/bash

                ​

                \                # Needed for git operations

                \                apk add -U git

                ​

                \               \ 

                \                PIPELINE_EXECUTION_ID=\"<+pipeline.executionId>\"

                \                COMMIT_SHA=\"<+codebase.commitSha>\"

                \                DEFAULT_BRANCH=\"<+codebase.branch>\"

                \                SOURCE_BRANCH=\"<+codebase.sourceBranch>\"

                \                CODEBASE_BRANCH=$DEFAULT_BRANCH && [ $SOURCE_BRANCH != \"null\"  ] && CODEBASE_BRANCH=$SOURCE_BRANCH

                \                DOCKER_TAG=\"<+​pipeline.executionId>\"


                \                # Debug input values

                \                echo \"BUILD_TYPE=$BUILD_TYPE\"

                \                echo \"DOCKER_IMAGE=${DOCKER_IMAGE}\"

                \                echo \"TAG_OVERRIDE=${TAG_OVERRIDE}\"

                \                echo \"TAG_PREFIX=${TAG_PREFIX}\"

                \                echo \"ADD_GIT_TAG=${ADD_GIT_TAG}\"

                \                echo \"PIPELINE_EXECUTION_ID=${PIPELINE_EXECUTION_ID}\"

                \                echo \"COMMIT_SHA=${COMMIT_SHA}\"

                \                echo \"CODEBASE_BRANCH=${CODEBASE_BRANCH}\"

                \                echo \"DOCKET_TAG=${DOCKER_TAG}\"

                ​

                \                git tag $DOCKER_TAG

                \               "
            envVariables:
                TAG_PREFIX: <+input>
                DOCKER_IMAGE: <+input>
                TAG_OVERRIDE: <+input>
                ADD_GIT_TAG: <+input>
            outputVariables:
                - name: DOCKER_TAG
                - name: DOCKER_IMAGE_WITH_TAG
                - name: DOCKER_IMAGE
